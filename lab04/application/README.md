# Прокси сервер

## Как запустить
Для запуска необходимо установить `rust` и `cargo`.

Далее запустить в командной строке:
```shell
cargo run -q -- <server_port> <concurrency_level>
```

Затем выставить сервер как основной прокси для `http` адресов в своем браузере и делать запросы прямо из него.
`https` запросы не поддерживаются.

## Комментарии
Логи записываются в отдельные файлы `proxy_session_*.log` для каждой сессии.
В названии файла и самих логах используется время с начала UNIX эпохи в секундах.
В логи пишется время запроса, его метод, статус ответа и url.

Черный список с сайтами находится в файле `blacklist.json`,
В черный список вносится как сам указанный сайт, так и все его дочерние.

Информация о закешированных сайтах хранится в `cache_meta.json`,
сами данные закешированных сайтов хранятся в папке `cache`.
Файлы туда складываются по хешу строки url сайта. При сохранении файла в кеш и
попадании запроса в него в консоль выведется сообщение.

Метаданные (все) о закешированных сайтах перезаписываются в файл `cache_meta.json`
после каждого взаимодействия с кешом. Чтение файла один раз во время работы сервера при его запуске.
Сами закешированные сайты (пере)записываются при получении этого данных сайта.

Вообще в условии написано возвращать закешированный сайт без соединения с сервером,
но это как будто не всегда правильно. Некоторые сайты не прикладывают хедер `Cache-control`,
который отвечает за период, в течение которого данные в кеше будут актуальны.
Поэтому в любом случае необходимо создавать соединение с веб-сервером как минимум для отправки условного `GET` запроса,
и если на него пришел ответ `304 Not Modified` (который не содержит тела),
то можно вернуть с прокси закешированное значение. Если файл в кеше прокис,
то придет ответ с другим статусом и телом, и в зависимости от них, уже можно действовать по-другому.
